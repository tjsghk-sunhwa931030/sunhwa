<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 
 <mapper namespace="mybatis.UInfoDAOImpl">
 
 <!-- 리스트 출력수  -->
	<select id="getTotalCount" resultType="int">
  	SELECT COUNT(*) from info_univ
  </select>

 
 	
 <!-- 출력  -->
 	<select id="listPage" resultType="mybatis.MyBoardDTO">
  	SELECT * FROM (
  		SELECT Tb.*, rownum rNum FROM (
  			SELECT * FROM myboard ORDER BY idx DESC
  		) Tb
  	)
  	WHERE rNum BETWEEN #{param1} AND #{param2}
  	 </select>
 	
<!--대학 검색 체크리스트  -->
 	<select id="searchC" resultType="mybatis.AllInfoDTO" >
	SELECT * FROM (SELECT Tb.*, ROWNUM rNum FROM (SELECT * FROM info_univ WHERE 
		u_type =#{param1,jdbcType=VARCHAR}
		AND	uname LIKE '%'||#{param2,jdbcType=VARCHAR}||'%'
		AND location LIKE '%'||#{param3,jdbcType=VARCHAR}||'%'
		AND p_type LIKE '%'||#{param4,jdbcType=VARCHAR}||'%'
		)Tb)WHERE rNum BETWEEN #{param5,jdbcType=INTEGER} AND #{param6,jdbcType=INTEGER}

 	</select>

<!-- 학과 검색 체크리스트 -->
	
 	<select  id="searchH" resultType="mybatis.AllInfoDTO" >
 		SELECT * FROM info_major INNER JOIN info_univ ON info_major.univ_uname = info_univ.uname
 			WHERE  u_type =#{param1,jdbcType=VARCHAR}
 			AND	info_univ.uname LIKE '%'||#{param2}||'%'
			AND major LIKE '%'||#{param3}||'%'
			AND major1 LIKE '%'||#{param4}||'%'
			AND major2 LIKE '%'||#{param5}||'%'
			AND location LIKE '%'||#{param6}||'%'
 	</select>
 
 <!-- 전형 검색 체크리스트 -->	
 	<select  id="searchJ" resultType="mybatis.AllInfoDTO" >
 		SELECT * FROM info_junh INNER JOIN info_univ ON info_junh.univ_uname = info_univ.uname
 								INNER JOIN info_major On info_junh.major_idx = info_major.idx
 			WHERE major_idx = #{param1}
 			AND	u_type =#{param2,jdbcType=VARCHAR}
 			AND	info_univ.uname LIKE '%'||#{param3}||'%'
			AND recruit_time LIKE '%'||#{param4}||'%'
			AND enter_type LIKE '%'||#{param5}||'%'
			AND enter_name LIKE '%'||#{param6}||'%'
			AND location LIKE '%'||#{param7}||'%'
			AND enter_ele LIKE '%'||#{param8,jdbcType=VARCHAR}||'%'
			AND major LIKE '%'||#{param9}||'%'
			AND major1 LIKE '%'||#{param10}||'%'
			AND major2 LIKE '%'||#{param11}||'%'
 	</select>
 	
 <!-- 대계열 검색 -->
 	<select id="listM1" resultType="mybatis.AllInfoDTO">
 		SELECT * FROM info_major
 	</select>
 <!-- 중계열 검색 -->	
 	<select id="listMj2" resultType="mybatis.AllInfoDTO">
 		SELECT major2 from info_major WHERE major1 LIKE '%'||#{param1}||'%'
 	</select>
 <!-- 전공명 검색 -->	
 	<select id="listMj3" resultType="mybatis.AllInfoDTO">
 		SELECT major from info_major WHERE major1 LIKE '%'||#{param1}||'%' AND major2 LIKE '%'||#{param2}||'%'
 	</select>
 	
 <!-- 관심대학 추가 -->
 	<insert id="interest_chk">
 		INSERT INTO interest_univ(idx,id,univ_uname)
 		 VALUES (interest_seq.nextval,#{param1},#{param2,jdbcType=VARCHAR}) 
 	</insert>
 	
 <!-- 관심대학 삭제 -->
 	<delete id="interest_unchk">
 		DELETE FROM interest_univ WHERE id=#{param1} AND univ_uname=#{param2,jdbcType=VARCHAR}
 	</delete>
 	
 <!-- 관심전형 추가 -->
 	<insert id="interest_chkJ">
 		INSERT INTO interest_junh(idx,id,major_idx)
 		 VALUES (interest_seq.nextval,#{param1},#{param2,jdbcType=VARCHAR}) 
 	</insert>
 	
 <!-- 관심전형 삭제 -->
 	<delete id="interest_unchkJ">
 		DELETE FROM interest_junh WHERE id=#{param1} AND major_idx=#{param2,jdbcType=VARCHAR}
 	</delete>
 	
 
	
 </mapper>
  
